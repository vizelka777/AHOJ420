{{define "content"}}
<div class="panel">
  <h1 style="margin-top:0;">Create OIDC Client</h1>
  <p class="hint">This form writes to PostgreSQL and reloads OIDC runtime clients immediately.</p>

  {{if .Error}}
    <div class="error">{{.Error}}</div>
  {{end}}

  <form method="post" action="/admin/clients/new" data-require-reauth="1" data-reauth-check="create-confidential-client">
    <input type="hidden" name="csrf_token" value="{{.CSRFToken}}">
    <div class="row">
      <div>
        <label for="id">Client ID</label>
        <input id="id" type="text" name="id" value="{{.Form.ID}}" required>
      </div>
      <div>
        <label for="name">Name</label>
        <input id="name" type="text" name="name" value="{{.Form.Name}}">
      </div>
    </div>

    <div class="row">
      <div>
        <label for="confidential">Client type</label>
        <select id="confidential" name="confidential">
          <option value="false" {{if not .Form.Confidential}}selected{{end}}>Public</option>
          <option value="true" {{if .Form.Confidential}}selected{{end}}>Confidential</option>
        </select>
      </div>
      <div>
        <label for="auth_method">Auth method</label>
        <select id="auth_method" name="auth_method">
          <option value="none" {{if eq .Form.AuthMethod "none"}}selected{{end}}>none</option>
          <option value="basic" {{if eq .Form.AuthMethod "basic"}}selected{{end}}>basic</option>
          <option value="post" {{if eq .Form.AuthMethod "post"}}selected{{end}}>post</option>
        </select>
      </div>
    </div>

    <div class="row">
      <div>
        <label><input type="checkbox" name="enabled" value="true" {{if .Form.Enabled}}checked{{end}}> Enabled</label>
      </div>
      <div>
        <label><input type="checkbox" name="require_pkce" value="true" {{if .Form.RequirePKCE}}checked{{end}}> Require PKCE</label>
      </div>
    </div>

    <div class="row">
      <div>
        <label for="grant_types">Grant types (comma or newline separated)</label>
        <textarea id="grant_types" name="grant_types">{{.Form.GrantTypesRaw}}</textarea>
      </div>
      <div>
        <label for="response_types">Response types (comma or newline separated)</label>
        <textarea id="response_types" name="response_types">{{.Form.ResponseTypesRaw}}</textarea>
      </div>
    </div>

    <div class="row">
      <div>
        <label for="scopes">Scopes (comma or newline separated)</label>
        <textarea id="scopes" name="scopes">{{.Form.ScopesRaw}}</textarea>
      </div>
      <div>
        <label for="redirect_uris">Redirect URIs (one per line)</label>
        <textarea id="redirect_uris" name="redirect_uris">{{.Form.RedirectURIsRaw}}</textarea>
      </div>
    </div>

    <div class="row">
      <div>
        <label for="initial_secret">Initial secret (required for confidential)</label>
        <input id="initial_secret" type="password" name="initial_secret" value="{{.Form.InitialSecret}}">
      </div>
      <div>
        <label for="initial_secret_label">Initial secret label</label>
        <input id="initial_secret_label" type="text" name="initial_secret_label" value="{{.Form.InitialSecretLabel}}">
      </div>
    </div>

    <div class="actions">
      <button type="submit">Create client</button>
      <a class="btn secondary" href="/admin/clients">Cancel</a>
    </div>
  </form>
</div>
{{end}}
